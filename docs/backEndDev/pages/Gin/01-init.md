# Ginæ¡†æ¶

## Ginçš„ä»‹ç»

[Gin](https://gin-gonic.com/zh-cn/docs/quickstart/) æ˜¯ä¸€ä¸ªç”¨ Go ç¼–å†™çš„ Web æ¡†æ¶ï¼Œ æ˜¯ä¸€ä¸ªå¿«é€Ÿã€è½»é‡çº§ã€çµæ´»å’Œæ˜“äºä½¿ç”¨çš„ Web æ¡†æ¶ï¼Œéå¸¸é€‚åˆæ„å»ºå„ç§ç±»å‹çš„ Web åº”ç”¨ç¨‹åºï¼Œç‰¹åˆ«æ˜¯å¯¹äºéœ€è¦é«˜æ€§èƒ½çš„åº”ç”¨ç¨‹åºã€‚å®ƒæä¾›äº†é«˜æ€§èƒ½çš„è·¯ç”±å’Œä¸­é—´ä»¶åŠŸèƒ½ï¼Œä½¿å¾—å¼€å‘ Web åº”ç”¨ç¨‹åºå˜å¾—æ›´åŠ ç®€å•å’Œå¿«é€Ÿã€‚

- å¿«é€Ÿï¼šGin æ¡†æ¶å…·æœ‰å“è¶Šçš„æ€§èƒ½ï¼Œå…¶é€Ÿåº¦æ¯”å…¶ä»–æµè¡Œçš„ Web æ¡†æ¶æ›´å¿«ã€‚
- è½»é‡çº§ï¼šGin æ¡†æ¶å…·æœ‰éå¸¸å°çš„å†…å­˜å ç”¨å’ŒäºŒè¿›åˆ¶æ–‡ä»¶å¤§å°ï¼Œéå¸¸é€‚åˆæ„å»ºè½»é‡çº§çš„ Web åº”ç”¨ç¨‹åºã€‚
- è·¯ç”±ï¼šGin æ¡†æ¶æä¾›äº†çµæ´»çš„è·¯ç”±åŠŸèƒ½ï¼Œå¯ä»¥è½»æ¾å¤„ç†å„ç§ HTTP è¯·æ±‚ã€‚
- ä¸­é—´ä»¶ï¼šGin æ¡†æ¶æ”¯æŒä¸­é—´ä»¶ï¼Œå¯ä»¥é€šè¿‡ä¸­é—´ä»¶æ¥æ·»åŠ å„ç§åŠŸèƒ½ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€æ—¥å¿—è®°å½•ã€ç¼“å­˜ç­‰ã€‚
- é”™è¯¯å¤„ç†ï¼šGin æ¡†æ¶æä¾›äº†æ–¹ä¾¿çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œå¯ä»¥è½»æ¾åœ°å¤„ç†å„ç§é”™è¯¯æƒ…å†µã€‚
- æ¨¡æ¿ï¼šGin æ¡†æ¶æ”¯æŒæ¨¡æ¿åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨å„ç§æ¨¡æ¿å¼•æ“æ¥æ¸²æŸ“è§†å›¾ã€‚
- JSON åºåˆ—åŒ–ï¼šGin æ¡†æ¶å†…ç½®äº† JSON åºåˆ—åŒ–å’Œååºåˆ—åŒ–åŠŸèƒ½ï¼Œå¯ä»¥è½»æ¾åœ°å°†æ•°æ®åºåˆ—åŒ–ä¸º JSON æ ¼å¼ã€‚
- æ–‡ä»¶ä¸Šä¼ ï¼šGin æ¡†æ¶æ”¯æŒæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œå¯ä»¥è½»æ¾å¤„ç†æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½æ“ä½œã€‚
- è‡ªå®šä¹‰ä¸­é—´ä»¶ï¼šGin æ¡†æ¶å…è®¸å¼€å‘è€…ç¼–å†™è‡ªå®šä¹‰ä¸­é—´ä»¶ï¼Œä»¥ä¾¿æ·»åŠ è‡ªå®šä¹‰åŠŸèƒ½ã€‚

## Ginçš„ä½¿ç”¨

å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨é¡¹ç›®ä¸­ä½¿ç”¨Ginæ¡†æ¶çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºæˆ‘ä»¬çš„é¡¹ç›®ç›®å½•ï¼Œç„¶ååœ¨é¡¹ç›®å†…åˆå§‹åŒ–ã€‚é€šè¿‡ä½¿ç”¨`go mod init projectName`çš„æ–¹å¼æ¥è¿›è¡Œåˆå§‹åŒ–ã€‚

![image-20230405221841352](https://oss.oh-undefined.com/image-20230405221841352.png)

```go
// go.mod
module go-WebServer

go 1.20
```

åˆå§‹åŒ–å®Œæˆåæˆ‘ä»¬çš„é¡¹ç›®ç›®å½•ä¸­ä¼šç”Ÿæˆä¸€ä¸ª`go.mod`çš„æ–‡ä»¶è¡¨æ˜æˆ‘ä»¬çš„é¡¹ç›®å·²ç»åˆå§‹åŒ–å®Œæˆã€‚

åˆå§‹åŒ–å®Œæˆåæˆ‘ä»¬ä¾¿å¯ä»¥æŒ‰ç…§Gin[å®˜ç½‘](https://gin-gonic.com/zh-cn/docs/quickstart/)æ‰€ç¤ºçš„å¿«é€Ÿæµç¨‹è¿›è¡Œå¯¹åº”æ¡†æ¶çš„å®‰è£…ã€‚

### è¦æ±‚

- Go 1.13 åŠä»¥ä¸Šç‰ˆæœ¬

### å®‰è£…

1. ä¸‹è½½å¹¶å®‰è£… ginï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­è¿è¡Œè¿™æ¡å‘½ä»¤ã€‚

   ```sh
   go get -u github.com/gin-gonic/gin
   ```

2. å°† gin å¼•å…¥åˆ°ä»£ç ä¸­ï¼Œæˆ‘è¿™é‡Œé»˜è®¤å°±å…ˆæ”¾åœ¨äº†main.goæ–‡ä»¶ä¸­ï¼Œå¦‚æœä¸å­˜åœ¨çš„æƒ…å†µä¸‹ä½ å¯ä»¥è‡ªè¡Œåˆ›å»ºä¸€ä¸ªã€‚

   ```go
   import "github.com/gin-gonic/gin"
   ```

3. å¦‚æœä¸ä¼šä½¿ç”¨çš„æƒ…å†µä¸‹ï¼ŒGinæ¡†æ¶é»˜è®¤ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåˆå§‹åŒ–çš„æ¨¡æ¿ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æ‹·è´è¿›å»ã€‚

   ```sh
   curl https://raw.githubusercontent.com/gin-gonic/examples/master/basic/main.go > main.go
   ```

4. è¿è¡Œé¡¹ç›®

   ```go
   go run main.go
   ```

### å¼€å§‹

è¿™é‡ŒGinçš„å®˜ç½‘æœ‰æç¤ºï¼Œå¦‚æœä¸ä¼šçš„ç¼–å†™æˆ–è€…æ‰§è¡ŒGoçš„ä»£ç çš„æƒ…å†µä¸‹ï¼Œç»™äº†ä¸€ä¸ªé“¾æ¥ï¼Œè·³çš„æ˜¯Goçš„[å®˜ç½‘ğŸ¤£](https://go.dev/doc/code)ã€‚

ç„¶ååˆ›å»ºä¸€ä¸ªåä¸º `example.go` çš„æ–‡ä»¶

```sh
touch example.go
```

ç„¶åä¹¦å†™`example.go`æ–‡ä»¶

```go
package main

import "github.com/gin-gonic/gin"

func main() {
	// å¼•å…¥Ginçš„è·¯ç”±
	router := gin.Default()
	// è·¯ç”±çš„GETæ–¹æ³• è®¿é—®åœ°å€ä¸ºindex 
	router.GET("/index",func(ctx *gin.Context) {
		// è¿”å›çš„æ˜¯ä¸€ä¸ªJSONæ•°æ®
		ctx.JSON(200,gin.H{
			"message":"Hello World",
		})
		// gin.H æ˜¯ Gin æ¡†æ¶ä¸­æä¾›çš„ä¸€ä¸ªç”¨äºåˆ›å»º map çš„ç®€ä¾¿æ–¹å¼ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ›´å¿«ã€æ›´æœ‰æ•ˆåœ°åˆ›å»º JSON å“åº”ã€‚
	})
	// è·¯ç”±ç›‘å¬ 8080ç«¯å£
	router.Run(":8080")
}
```

ç„¶å, æ‰§è¡Œ `go run example.go` å‘½ä»¤æ¥è¿è¡Œä»£ç ï¼š

```sh
# go run example.go 
# [GIN-debug] Listening and serving HTTP on :8080
```

è®¿é—®ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚

![image-20230405223902767](https://oss.oh-undefined.com/image-20230405223902767.png)

å®Œäº‹ï¼æ°´äº†ä¸€ç¯‡ï¼Œå› ä¸ºGoè¯­è¨€ä¸­çš„éƒ¨åˆ†åŸºç¡€çŸ¥è¯†è¿˜æ²¡æœ‰ææ˜ç™½ï¼Œæ‰“ç®—é€šè¿‡Webæ¡†æ¶å®é™…ä½¿ç”¨ä¸å­¦ä¹ åŸºç¡€çŸ¥è¯†åŒæ­¥è¿›è¡Œï¼Œå­¦åˆ°å“ªé‡Œä¸æ˜ç™½äº†å°±ç»§ç»­å›å»å­¦å¯¹åº”çš„åŸºç¡€çŸ¥è¯†ã€‚ç¥æ„¿å¤§å®¶å˜å¾—æ›´å¼ºã€‚

![image-20230405224400360](https://oss.oh-undefined.com/image-20230405224400360.png)
